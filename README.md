# Hong Kong Ombudsman Reports Web App | 香港申訴專員公署報告網頁應用程式

A bilingual Next.js web application for processing and displaying Hong Kong Ombudsman reports data. This app provides a web interface for the functionality of the Python script `generate_reports_table.py` with full Traditional Chinese support.

## Features

- **🌐 Bilingual Interface**: Complete Traditional Chinese and English localization
- **🧠 Smart Language Detection**: Automatically detects browser language and defaults to Traditional Chinese for Hong Kong users
- **📊 CSV Data Processing**: Upload PDF processing log CSV files generated by `rename_pdfs_with_ai.py`
- **🔍 Advanced Search & Filter**: Search through reports and filter by year, report type, and organization
- **📑 Multi-language Reports**: Display titles in English, Traditional Chinese, and Simplified Chinese
- **📤 Export Options**: Download processed data as CSV with filtering applied
- **🔗 Direct File Access**: Click links to view PDF reports directly in browser
- **💾 Language Persistence**: Remembers your language preference across sessions

## Getting Started

### Prerequisites

- Node.js 18+ 
- npm or yarn

### Installation

1. **Install dependencies**:
   ```bash
   cd ombudsman-reports-app
   npm install
   ```

2. **Run the development server**:
   ```bash
   npm run dev
   ```

3. **Open your browser** and navigate to [http://localhost:3000](http://localhost:3000)

The app will automatically detect your browser language:
- **Chinese users** (zh-HK, zh-TW, zh-MO, zh-Hant): Defaults to Traditional Chinese
- **Other languages**: Traditional Chinese (given Hong Kong context)
- **Manual switching**: Use the 繁中/EN toggle in the top-right corner

### Building for Production

```bash
npm run build
npm start
```

## Usage

1. **Language Selection**: The app automatically detects your language preference or you can toggle between 繁中/EN
2. **Data Loading**: The app loads report data from the CSV file in the public directory
3. **Search & Filter**: Use the search bar and filter dropdowns to find specific reports
4. **View Reports**: Click on EN/繁中/简中 links to view reports directly in your browser
5. **Export Data**: Download the filtered results as CSV using the download button

## Data Format

The app expects CSV files with the following structure (generated by `rename_pdfs_with_ai.py`):

- `status`: Processing status (should be 'SUCCESS' for included reports)
- `ai_response_json`: JSON string containing AI-extracted metadata
- `new_symlink_path_or_error`: File path to the processed PDF

### AI Response JSON Structure

The `ai_response_json` field should contain:

```json
{
  "report_number": "OMB 1997/2136",
  "core_title": "Report title",
  "language": "EN|TC|SC",
  "report_type_code": "DI|FI|AR|Code|Complaint|Other",
  "organizations_concerned": "Organization name",
  "department_code": "DEPT",
  "date_completed": "YYYY-MM-DD",
  "date_declared": "YYYY-MM-DD",
  "financial_year": "1997/98"
}
```

## Components

### LanguageSwitcher
Language toggle component with:
- Browser language detection
- Traditional Chinese / English switching
- Persistent language preference storage

### ReportsTable
Comprehensive table component with:
- Bilingual interface support
- Search functionality across all fields
- Multi-column filtering (year, type, organization)
- Sortable columns with visual indicators
- Direct PDF viewing links for all language versions

### Internationalization System
- Complete translation system with `lib/i18n.ts`
- React hook for language management (`useLanguage`)
- Local storage persistence for user preferences
- Automatic Traditional Chinese font loading (Noto Sans TC)

### Report Processor
Core logic for:
- Validating case references (OMB, CAC, OCAC formats)
- Processing department codes against standardized list
- Grouping reports by case reference
- Creating structured table data with multilingual support

## Department Codes

The app includes a comprehensive mapping of Hong Kong government department codes, including:

- **Bureaus**: CEDB, DEVB, EDB, FSTB, etc.
- **Departments**: AFCD, BD, DH, EPD, FSD, etc.
- **Authorities**: HA, ICAC, etc.
- **Offices**: OFCA, OGCIO, REO, etc.

## Technology Stack

- **Framework**: Next.js 15 with App Router
- **Language**: TypeScript
- **Styling**: Tailwind CSS with custom Chinese font support
- **Internationalization**: Custom i18n system with Traditional Chinese
- **Fonts**: Inter (Latin) + Noto Sans TC (Chinese)
- **Icons**: Lucide React
- **CSV Processing**: PapaParse
- **Build Tool**: Next.js built-in with standalone output

## File Structure

```
ombudsman-reports-app/
├── app/
│   ├── layout.tsx          # Root layout with Chinese font support
│   ├── page.tsx            # Main page with i18n integration
│   └── globals.css         # Global styles
├── components/
│   ├── LanguageSwitcher.tsx # Language toggle component
│   └── ReportsTable.tsx    # Bilingual reports table
├── lib/
│   ├── i18n.ts             # Internationalization system
│   ├── useLanguage.ts      # Language management hook
│   ├── types.ts            # TypeScript interfaces
│   └── reportProcessor.ts  # Core processing logic
├── public/
│   └── reports_table.csv   # Report data file
├── package.json
├── next.config.js
├── tailwind.config.js      # Extended with Chinese fonts
├── tsconfig.json
├── Dockerfile             # Production containerization
└── docker-compose.yml     # Development/production setup
```

## Integration with Python Scripts

This web app is designed to work with the existing Python toolkit:

1. **Data Source**: Uses CSV files generated by `rename_pdfs_with_ai.py`
2. **Processing Logic**: Implements the same data processing as `generate_reports_table.py`
3. **Department Codes**: Uses the same mapping as defined in the Python scripts
4. **Case Reference Validation**: Follows the same validation rules

## Language Support

### Automatic Detection
The app automatically detects your browser's language preference:

- **Traditional Chinese**: zh-HK, zh-TW, zh-MO, zh-Hant
- **Default**: Traditional Chinese (appropriate for Hong Kong context)
- **Manual Override**: Users can always switch manually using the 繁中/EN toggle

### Included Translations
- Complete interface translation (Traditional Chinese ⟷ English)
- All UI elements: headers, buttons, filters, messages, error states
- Localized metadata and page titles
- Chinese font optimization for better readability

## Future Enhancements

- **Simplified Chinese**: Add SC (简体中文) as a third language option
- **Advanced Search**: Add full-text search within report content
- **Data Export**: Support for additional export formats (Excel, JSON)
- **Report Analytics**: Add statistics and visualization features
- **Mobile Optimization**: Enhanced mobile experience for Chinese text
- **Accessibility**: Improve screen reader support for bilingual content

## Contributing

This app is part of the Hong Kong Ombudsman PDF processing toolkit. Please ensure compatibility with the existing Python scripts when making changes.

## License

This project is part of the Hong Kong Ombudsman reports processing toolkit.